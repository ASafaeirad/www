---
import type { GetStaticPaths } from "astro";
import { concepts } from "@/data/concepts";
import Layout from "@/layouts/layout.astro";
import Container from "@/components/container.astro";
import Hero from "@/components/hero.astro";
import ConceptComponent from "@/components/concepts/concept.astro";
import Footer from "@/components/footer.astro";

export const getStaticPaths = (() => {
  const allConcepts = concepts
    .map((category) =>
      category.concepts.map((concept) => ({
        category: category.title,
        categorySlug: category.slug,
        ...concept,
      }))
    )
    .flat();

  return allConcepts.map((concept) => ({
    params: { category: concept.categorySlug, concept: concept.slug },
    props: { concept },
  }));
}) satisfies GetStaticPaths;

const { concept } = Astro.props;
---

<Layout>
  <Container>
    <Hero
      title={concept.name}
      description={`${concept.resources.length} resource${concept.resources.length !== 1 ? "s" : ""}.`}
      backLabel={`${concept.category} ðŸ“ƒ`}
      backUrl={`/concepts/${concept.categorySlug}`}
    />
    <ConceptComponent eli5={concept.eli5} resources={concept.resources} />
    <Footer />
  </Container>
</Layout>
